$(document).ready(function(){var e,h=S3.supply.binnedQuantity||0,c,p=$("#sub-defaultbin"),q=$("#inv_adj_item_sub_defaultbin"),d,l=$("#sub_defaultbin_defaultbin_i_quantity_edit_none"),f,u=/(\d)(?=(\d{3})+(?!\d))/g,k=$("#sub_defaultbin_defaultbin_i_quantity_edit_0"),a,m=$("#inv_adj_item_new_quantity"),b=m.val(),v=m.closest("form");b=b?parseFloat(b):S3.supply.oldQuantity||0;v.on("submit.s3",function(g){m.val()||(g.preventDefault(),d="Enter a number greater than or equal to 0",c=$('<div id="inv_adj_item_new_quantity-error" class="alert alert-error" style="padding-left:36px;">'+
d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),m.parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1}))});m.on("change",function(){(b=m.val())?(b=parseFloat(b),$("#inv_adj_item_new_quantity-error").remove(),$("#inv_adj_item_new_quantity-warning").remove()):b=S3.supply.oldQuantity||0;0>b&&(b=0,d="Quantity cannot be Negative",c=$('<div id="inv_adj_item_new_quantity-warning" class="alert alert-warning" style="padding-left:36px;">'+
d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),m.val(b).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1}));f=(f=l.val())?parseFloat(f):0;a=k.is(":visible")?(a=k.val())?parseFloat(a):0:0;e=h+f+a;if(b<e)if(f>=e-b)d="Quantity in Bins reduced to Total Quantity",c=$('<div id="sub_defaultbin_defaultbin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
l.val(f-(e-b)).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1});else if(a>=e-b)d="Quantity in Bins reduced to Total Quantity",c=$('<div id="sub_defaultbin_defaultbin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),k.val(a-(e-b)).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();
return!1});else{var g=q.data("data");g||(g=JSON.parse(q.val()),q.data("data",g));g=g.data;var n=[],r;for(r in g)n.push(r);1==n.length?(f&&(l.val(0),e-=f),a?(a-=e-b,k.val(a)):p.inlinecomponent("updateRows",function(t){t.quantity.value=b;t.quantity.text=b.toString().replace(u,"$1,")}),d="Quantity in Bins reduced to Total Quantity",c=$('<div id="sub_defaultbin_defaultbin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
l.parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1})):(b=h,d="You need to reduce the Quantity in the Bins before you can reduce the Total Quantity",c=$('<div id="inv_adj_item_new_quantity-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),m.val(b).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();
return!1}))}});l.on("change",function(){f=(f=l.val())?parseFloat(f):0;e=b-h;f>e&&(d="Quantity in Bins cannot be higher than Total Quantity",c=$('<div id="sub_defaultbin_defaultbin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),l.val(e).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1}))});k.on("change",function(){a=(a=
k.val())?parseFloat(a):0;e=b-h;a>e&&(d="Quantity in Bins cannot be higher than Total Quantity",c=$('<div id="sub_defaultbin_defaultbin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+d+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),k.val(e).parent().append(c).off(".s3").on("click.s3",".alert",function(){$(this).fadeOut("slow").remove();return!1}))});p.on("click.s3",".inline-edt",function(){a=(a=k.val())?parseFloat(a):0;h-=a});
$("#rdy-defaultbin-0").on("click",function(){a=(a=k.val())?parseFloat(a):0;h+=a;l.trigger("change")});p.on("editCancelled",function(g,n){a=parseFloat(q.data("data").data[n].quantity.value);h+=a});p.on("rowAdded",function(g,n){h+=parseFloat(n.quantity.value);$("#sub_defaultbin_defaultbin_i_quantity_edit_none-warning").remove()});p.on("rowRemoved",function(g,n){h-=parseFloat(n.quantity.value)})});
